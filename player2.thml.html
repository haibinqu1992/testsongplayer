<html lang="en">
<head>
  <title> Responsive Spotify</title>
  <meta charset="utf=8"/>
  <link rel="stylesheet" href="zz.css" type="text/css"/>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

</head>
<body>

<div id="nav">
	<ul>
		<li>Home</li>
		<li class="13 Clean"><button onclick="add(this)">Add</button></li>
	</ul>

</div>

<iframe id="search1" src="demo_iframe.html" ></iframe>


<div id="list">
	<ul id="foo">
	
	
	
	</ul>
</div>


	<div id="bottom">
		<input id ="action" type="image" src="pause.png" onclick="play()"></input>
		<audio id="audio" src="songs/02 Blank Space.m4a"></audio>



<div id="songinfo">
	<p id="info" >Blank Space - Taylor Swift</p>
	
</div>
<input id ="action1" type="image" src="previous.png" onclick="previous()"></input>
<input id ="action1" type="image" src="next.png" onclick="next()"></input>

		

<img onclick="extract()" id="listicon" src="playlist.png" width="50px" >


		<div id="myProgress">
  <div id="myBar"></div>
</div>

			</div>



<script type="text/javascript">
var slist;
var dir="songs/";
var ext=".m4a";
audio=new Audio();

var songlist=["01 Welcome To New York","02 Blank Space", "03 Style", "04 Out of The Woods", "05 All You Had To Do Was Stay", "06 Shake It Off","07 I Wish You Would"];

mylist=document.getElementById("list");
mylist.addEventListener("click", changesong);
document.getElementById("myProgress").addEventListener("click",barclick);
var z=false;

var playindex=0;

audio.src=dir+songlist[playindex]+ext;
audio.play();
document.getElementById("info").innerHTML=songlist[playindex];
audio.onended=function(){

	if(playindex==songlist.length-1)
	{
		playindex=0;
		audio.src=dir+songlist[playindex]+ext;
	audio.play();
	document.getElementById("info").innerHTML=songlist[playindex];

	document.getElementById("foo").innerHTML="";
	pushsongs();
	}
	else
		{playindex++;
	audio.src=dir+songlist[playindex]+ext;
	audio.play();
	document.getElementById("info").innerHTML=songlist[playindex];

	document.getElementById("foo").innerHTML="";
	pushsongs();
}
}


function add(e){
alert(e.parentNode.class);
songlist.push(e.parentNode.id);
document.getElementById("foo").innerHTML="";
	pushsongs();
}


function previous(){

if(playindex==0)
	{
		playindex=songlist.length-1;
		audio.src=dir+songlist[playindex]+ext;
		audio.play();
		
		document.getElementById("info").innerHTML=songlist[playindex];
	document.getElementById("action").src="pause.png";


	}
else{
	playindex--;
	audio.src=dir+songlist[playindex]+ext;
	audio.play();
	document.getElementById("info").innerHTML=songlist[playindex];
	document.getElementById("action").src="pause.png";

	document.getElementById("foo").innerHTML="";
	pushsongs();

}
}

function next(){
	if(playindex==songlist.length-1)
	{
		playindex=0;
		audio.src=dir+songlist[playindex]+ext;
		audio.play();
		document.getElementById("info").innerHTML=songlist[playindex];
	document.getElementById("action").src="pause.png";

	document.getElementById("foo").innerHTML="";
	pushsongs();

	}
else{
	playindex++;
	audio.src=dir+songlist[playindex]+ext;
	audio.play();
	document.getElementById("info").innerHTML=songlist[playindex];
	document.getElementById("action").src="pause.png";


	document.getElementById("foo").innerHTML="";
	pushsongs();
	
}

}


function pushsongs(){
	

	for(i=0; i<songlist.length; i++)
	{
		if(i!==playindex){
		slist=document.getElementById("foo").innerHTML;
		var name=songlist[i];
		document.getElementById("foo").innerHTML=slist + '<li id="'+ name +'">' + name + '<button onclick="removeli(this)">delete</button></li>';
		document.getElementById(name).style.background="white";
		
	}

	else{
		slist=document.getElementById("foo").innerHTML;
		var name=songlist[i];
		document.getElementById("foo").innerHTML=slist + '<li id="'+ name +'">' + name + '<button onclick="removeli(this)">delete</button></li>';
		document.getElementById(name).style.background="blue";
	
}
		
	}
}





function barclick(e){
		var barlength=document.getElementById("myProgress").offsetWidth
		var x=e.pageX-this.offsetLeft;
		var time=x/barlength*audio.duration;
		
		audio.currentTime=time;
	
}



function removeli(e){
e.parentNode.remove();
event.stopPropagation();

var index = songlist.indexOf(e.parentNode.id);

songlist.splice(index,1);

document.getElementById("foo").innerHTML="";
	pushsongs();

}


function changesong(event){
	var name=event.target.id;
	
	var index = songlist.indexOf(name);
	playindex=index;

	audio.src=dir+event.target.id+ext;
	document.getElementById("info").innerHTML=event.target.id;
	
	audio.play();
	
		document.getElementById("action").src="pause.png";

		document.getElementById("foo").innerHTML="";
	pushsongs();
}


function play() {

		
		
		if(audio.paused)
		{
		
		audio.play();
		document.getElementById("action").src="pause.png";
		

		
		
	}
else
{
	audio.pause();
	document.getElementById("action").src="play.png";
}
	}


function barplay()
{

	var cur=audio.currentTime;
		var dur=audio.duration;
		var z=cur/dur*100;
		var b=z+'%';
	document.getElementById('myBar').style.width=b;
setTimeout(barplay,100);
	

}



function extract(){
	
	if(z==false){

	document.getElementById("list").style.display="block";
	z=true;
}
else 
{
	document.getElementById("list").style.display="none";
	z=false;
}

}

pushsongs();
barplay();



</script>
</body>
</html>
